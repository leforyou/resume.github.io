<!DOCTYPE html>
<html>

	<head>
		<title></title>
		<meta charset="utf-8">
		<meta name="description" content="">
		<meta name="keywords" content="">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="css/api.css" rel="stylesheet">
		<link href="css/style.css" rel="stylesheet">
		<style type="text/css">

		</style>
	</head>

	<body>
		<div class="home">
			
			
			<div class="home-product" id="products">
				<div class="box">
					<ul>
						<li>
							<div class="left">
								<i class="ico-plus"></i>
								<img class="num" src="img/small-number1.png"/>
								<div class="cn">修护</div>
								<div class="en">Repair</div>
							</div>
							<div class="img-box">
								<p style="background-image: url(img/home-product1.jpg);"></p>
							</div>
						</li>
						<li>
							<div class="left">
								<i class="ico-plus"></i>
								<img class="num" src="img/small-number2.png"/>
								<div class="cn">保湿</div>
								<div class="en">Moisturizing</div>
							</div>
							<div class="img-box">
								<p style="background-image: url(img/home-product2.jpg);"></p>
							</div>
						</li>
						<li>
							<div class="left">
								<i class="ico-plus"></i>
								<img class="num" src="img/small-number3.png"/>
								<div class="cn">紧致</div>
								<div class="en">Firming</div>
							</div>
							<div class="img-box">
								<p style="background-image: url(img/home-product3.jpg);"></p>
							</div>
						</li>
						<li>
							<div class="left">
								<i class="ico-plus"></i>
								<img class="num" src="img/small-number4.png"/>
								<div class="cn">舒缓</div>
								<div class="en">Repair</div>
							</div>
							<div class="img-box">
								<p style="background-image: url(img/home-product4.jpg);"></p>
							</div>
						</li>
						
						
					</ul>
				</div>
			</div>
			
			
			<div class="product-layer">
				<div class="box">
					<div class="sort">
						<ul>
							<li>
								<div class="left">
									<div class="info">
										<img class="num" src="img/number1.png"/>
										<div class="sub-title">舒缓</div>
										<div class="describe">欧洲畅销草本复方甘草、洋甘菊、七叶树等成分，让肌肤快速舒缓不适，提高肌肤防护力，减少敏感肌。</div>
									</div>
								</div>
								<div class="right">
									<div class="img-box" style="background-image:url(img/home-product01.jpg);"></div>
								</div>
							</li>
							<li>
								<div class="left">
									<div class="info">
										<img class="num" src="img/number2.png"/>
										<div class="sub-title">清爽</div>
										<div class="describe">清爽，指清新凉爽；清楚；清晰。见《南史·柳惔传》：“ 惔非徒风韵清爽，亦属文遒丽。”吴语常用词，指干净。</div>
									</div>
								</div>
								<div class="right">
									<div class="img-box" style="background-image:url(img/home-product02.jpg);"></div>
								</div>
							</li>
							<li>
								<div class="left">
									<div class="info">
										<img class="num" src="img/number3.png"/>
										<div class="sub-title">美丽</div>
										<div class="describe">漂亮，好看；即在形式、比例、布局、风度、颜色或声音上接近完美或理想境界，使各种感官极为愉悦。</div>
									</div>
								</div>
								<div class="right">
									<div class="img-box" style="background-image:url(img/home-product03.jpg);"></div>
								</div>
							</li>
							<li>
								<div class="left">
									<div class="info">
										<img class="num" src="img/number4.png"/>
										<div class="sub-title">纯洁</div>
										<div class="describe">纯洁，比喻纯粹清白，没有污点，没有私心；而真正纯洁的人是经历人生的洗礼而依然保持本心的人（《爱莲说》：“出淤泥而不染，濯清涟而不妖。”）。</div>
									</div>
								</div>
								<div class="right">
									<div class="img-box" style="background-image:url(img/home-product04.jpg);"></div>
								</div>
							</li>
						</ul>
					</div>
					<div class="back">
						<img src="img/article_icon_back.png"/>
					</div>
					<div class="prev"></div>
					<div class="next"></div>
				</div>
			</div>
			
			
			
			
		</div>
		<script>
			
			
			window.addEventListener('DOMContentLoaded',function(){
				//产品遮罩
				var myLayer = new productLayer({
					el:'.product-layer',
					duration:500
				});
				
				//产品列表
				var liTag = document.querySelectorAll('#products ul li');
				for (var i = 0 ; i < liTag.length ; i ++) {
					liTag[i].index = i;
					liTag[i].addEventListener('click',function(){
						var index = this.index;
						myLayer.index(index);
					});
				}
				
			},false);
			function productLayer(obj){
				this.el = document.querySelector(obj.el);
				this.prev = this.el.querySelector('.prev');
				this.next = this.el.querySelector('.next');
				this.back = this.el.querySelector('.back');
				this.list = this.el.querySelectorAll('li');
				for (var i = 0 ; i < this.list.length ; i ++) {
					this.list[i].index = i;
				}
				this.prev.addEventListener('click',this.prevFn.bind(this));
				this.next.addEventListener('click',this.nextFn.bind(this));
				this.back.addEventListener('click',this.backFn.bind(this));
				
				this.listActiveIndex = 0;//索引
				this.duration = obj.duration || 500;//动画过渡时间
				this.cycleState = true;//记录状态-动画周期
			}
			productLayer.prototype.backFn = function(){
				//关闭
				this.el.classList.remove('active');
				this.translateFn('100%','-100%');
				for (var i = 0 ; i < this.list.length ; i ++) {
					this.list[i].classList.remove('active');
				}
				//重置.left和.right的translate3d位置
				this.durationZeroFn();
				this.translateFn('100%','-100%');
				
				var left = this.list[this.listActiveIndex].querySelector('.left');
				var right = this.list[this.listActiveIndex].querySelector('.right');
				
				left.style.transform = 'translate3d(0,0%,0)';
				right.style.transform = 'translate3d(0,0%,0)';
				var setTime = setTimeout(function(){
					left.style.transitionDuration = this.duration + 'ms';
					right.style.transitionDuration = this.duration + 'ms';
					left.style.transform = 'translate3d(0,100%,0)';
					right.style.transform = 'translate3d(0,-100%,0)';
					clearTimeout(setTime);
				}.bind(this),1);
			}
			productLayer.prototype.index = function(num){
				//显示
				if(num>this.list.length)return;
				this.listActiveIndex = num;
				var left = this.list[num].querySelector('.left');
				var right = this.list[num].querySelector('.right');
				this.durationZeroFn();
				this.translateFn('-100%','100%');
				var setTime = setTimeout(function(){
					this.el.classList.add('active');
					this.list[num].classList.add('active');
					left.style.transitionDuration = this.duration + 'ms';
					right.style.transitionDuration = this.duration + 'ms';
					left.style.transform = 'translate3d(0,0%,0)';
					right.style.transform = 'translate3d(0,0%,0)';
					clearTimeout(setTime);
				}.bind(this),1);
				
			}
			productLayer.prototype.prevFn = function(){
				//上一个
				this.unionPrevNextFn('prev');
				/*return;
				
				//退场动画：点击前重置元素的位置，确保方向一致性
				if(this.cycleState==false)return;
				this.durationZeroFn();
				this.translateFn('100%','-100%');
				
				
				var left = this.list[this.listActiveIndex].querySelector('.left');
				var right = this.list[this.listActiveIndex].querySelector('.right');
				
				left.style.transform = 'translate3d(0,0%,0)';
				right.style.transform = 'translate3d(0,0%,0)';
				
				setTimeout(function(){
					//退出
					var left = this.list[this.listActiveIndex].querySelector('.left');
					var right = this.list[this.listActiveIndex].querySelector('.right');
					left.style.transitionDuration = this.duration + 'ms';
					right.style.transitionDuration = this.duration + 'ms';
					left.style.transform = 'translate3d(0,-100%,0)';
					right.style.transform = 'translate3d(0,100%,0)';
					
					//设置激活类.active
					this.list[this.listActiveIndex].classList.remove('active');
					this.listActiveIndex -= 1;
					if(this.listActiveIndex<0)this.listActiveIndex=this.list.length-1;
					this.list[this.listActiveIndex].classList.add('active');
					
					//进入
					var left = this.list[this.listActiveIndex].querySelector('.left');
					var right = this.list[this.listActiveIndex].querySelector('.right');
					left.style.transitionDuration = this.duration + 'ms';
					right.style.transitionDuration = this.duration + 'ms';
					left.style.transform = 'translate3d(0,0%,0)';
					right.style.transform = 'translate3d(0,0%,0)';
				}.bind(this),1);
				
				//复位：动画结束后，让其它元素位置保持相应的位置，当前激活类的位置保持不变
				this.cycleState = false;
				var setTime = setTimeout(function(){					
					this.durationZeroFn();
					for (var i = 0 ; i < this.list.length ; i ++) {
						if(this.listActiveIndex==i)continue;//跳过
						var left = this.list[i].querySelector('.left');
						var right = this.list[i].querySelector('.right');
						left.style.transform = 'translate3d(0,100%,0)';
						right.style.transform = 'translate3d(0,-100%,0)';
					}
					this.cycleState = true;
				}.bind(this),this.duration+10);*/
			}
			productLayer.prototype.nextFn = function(){
				//下一个
				this.unionPrevNextFn('next');
				/*return;
				
				//退场动画：点击前重置元素的位置，确保方向一致性
				if(this.cycleState==false)return;
				this.durationZeroFn();
				this.translateFn('-100%','100%');
				
				var left = this.list[this.listActiveIndex].querySelector('.left');
				var right = this.list[this.listActiveIndex].querySelector('.right');
				
				left.style.transform = 'translate3d(0,0%,0)';
				right.style.transform = 'translate3d(0,0%,0)';
				
				setTimeout(function(){
					//退出
					var left = this.list[this.listActiveIndex].querySelector('.left');
					var right = this.list[this.listActiveIndex].querySelector('.right');
					left.style.transitionDuration = this.duration + 'ms';
					right.style.transitionDuration = this.duration + 'ms';
					left.style.transform = 'translate3d(0,100%,0)';
					right.style.transform = 'translate3d(0,-100%,0)';
					
					//设置激活类.active
					this.list[this.listActiveIndex].classList.remove('active');
					this.listActiveIndex += 1;
					if(this.listActiveIndex>(this.list.length-1))this.listActiveIndex=0;
					this.list[this.listActiveIndex].classList.add('active');
					
					//进入
					var left = this.list[this.listActiveIndex].querySelector('.left');
					var right = this.list[this.listActiveIndex].querySelector('.right');
					left.style.transitionDuration = this.duration + 'ms';
					right.style.transitionDuration = this.duration + 'ms';
					left.style.transform = 'translate3d(0,0%,0)';
					right.style.transform = 'translate3d(0,0%,0)';
				}.bind(this),1);
				
				//复位：动画结束后，让其它元素位置保持相应的位置，当前激活类的位置保持不变
				this.cycleState = false;
				var setTime = setTimeout(function(){					
					this.durationZeroFn();
					for (var i = 0 ; i < this.list.length ; i ++) {
						if(this.listActiveIndex==i)continue;//跳过
						var left = this.list[i].querySelector('.left');
						var right = this.list[i].querySelector('.right');
						left.style.transform = 'translate3d(0,-100%,0)';
						right.style.transform = 'translate3d(0,100%,0)';
					}
					this.cycleState = true;
				}.bind(this),this.duration+10);*/
			}
			productLayer.prototype.unionPrevNextFn = function(action){
				//联合操作
				//退场动画：点击前重置元素的位置，确保方向一致性
				if(this.cycleState==false)return;
				this.durationZeroFn();
				if(action=='prev'){
					this.translateFn('100%','-100%');
				}else if(action=='next'){
					this.translateFn('-100%','100%');
				}
				var left = this.list[this.listActiveIndex].querySelector('.left');
				var right = this.list[this.listActiveIndex].querySelector('.right');
				left.style.transform = 'translate3d(0,0%,0)';
				right.style.transform = 'translate3d(0,0%,0)';
				
				setTimeout(function(){
					//退出
					var left = this.list[this.listActiveIndex].querySelector('.left');
					var right = this.list[this.listActiveIndex].querySelector('.right');
					left.style.transitionDuration = this.duration + 'ms';
					right.style.transitionDuration = this.duration + 'ms';
					if(action=='prev'){
						left.style.transform = 'translate3d(0,-100%,0)';
						right.style.transform = 'translate3d(0,100%,0)';
					}else if(action=='next'){
						left.style.transform = 'translate3d(0,100%,0)';
						right.style.transform = 'translate3d(0,-100%,0)';
					}
					
					//设置激活类.active
					this.list[this.listActiveIndex].classList.remove('active');
					if(action=='prev'){
						this.listActiveIndex -= 1;
						if(this.listActiveIndex<0)this.listActiveIndex=this.list.length-1;
					}else if(action=='next'){
						this.listActiveIndex += 1;
						if(this.listActiveIndex>(this.list.length-1))this.listActiveIndex=0;
					}
					this.list[this.listActiveIndex].classList.add('active');
					
					//进入
					var left = this.list[this.listActiveIndex].querySelector('.left');
					var right = this.list[this.listActiveIndex].querySelector('.right');
					left.style.transitionDuration = this.duration + 'ms';
					right.style.transitionDuration = this.duration + 'ms';
					left.style.transform = 'translate3d(0,0%,0)';
					right.style.transform = 'translate3d(0,0%,0)';
				}.bind(this),1);
				
				//复位：动画结束后，让其它元素位置保持相应的位置，当前激活类的位置保持不变
				this.cycleState = false;
				var setTime = setTimeout(function(){					
					this.durationZeroFn();
					for (var i = 0 ; i < this.list.length ; i ++) {
						if(this.listActiveIndex==i)continue;//跳过
						var left = this.list[i].querySelector('.left');
						var right = this.list[i].querySelector('.right');
						if(action=='prev'){
							left.style.transform = 'translate3d(0,100%,0)';
							right.style.transform = 'translate3d(0,-100%,0)';
						}else if(action=='next'){
							left.style.transform = 'translate3d(0,-100%,0)';
							right.style.transform = 'translate3d(0,100%,0)';
						}
					}
					this.cycleState = true;
				}.bind(this),this.duration+10);
			}
			productLayer.prototype.translateFn = function(lval,rval){
				//设置动画位置
				for (var i = 0 ; i < this.list.length ; i ++) {
					var left = this.list[i].querySelector('.left');
					var right = this.list[i].querySelector('.right');
					left.style.transform = 'translate3d(0,'+lval+',0)';
					right.style.transform = 'translate3d(0,'+rval+',0)';
				}
			}
			productLayer.prototype.durationZeroFn = function(lval,rval){
				//设置动画时间为0
				for (var i = 0 ; i < this.list.length ; i ++) {
					var left = this.list[i].querySelector('.left');
					var right = this.list[i].querySelector('.right');
					left.style.transitionDuration = '0ms';
					right.style.transitionDuration = '0ms';
				}
			}
		</script>
	</body>

</html>